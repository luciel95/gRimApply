## (주)그림 입사지원을 위한 과제 1 
### 1. 개요
- 다음의 요구사항을 만족하는 프로그램을 MFC 기반으로 작성한다.
   - 과제 링크 https://doc.clickup.com/25596452/p/h/rd4h4-262778/9faf6d2e66ff9e7
   - 유튜브 에서 안내한 방법으로 구현하고 불필요한 드로잉 라이브러리는 사용하지 않는다.
### 2. 내용
- 클래스 구조
![클래스 구조](https://github.com/luciel95/gRimApply/blob/master/%ED%81%B4%EB%9E%98%EC%8A%A4%20%EA%B5%AC%EC%A1%B0.png?raw=true)
   - MFC 다이얼로그 기반 앱의 구조에 충실하게 CWimApp 클래스는 데이터 생성관리, CDialog클래스는 UI/가시화 기능으로 분리하여 구현함
   - 원의 수학적 정의를 클래스로 만들고, 이를 상속하여 필요한 클래스를 역시 만들어 객체지향프로그래밍에 준하도록 설계함
   - SW과제의 요구사항에 준하여 구현
### 핵심 알고리즘
- 화면 표시
   - 640X480 크기의 그레이스케일 프레임버퍼를 정의하고 컨텍스트 자원을 얻어 화면에 표시함
   - 도형 데이터를 읽어 해당 수학적 정의에 준하게 프레임에 렌더링 하는 작업을 분리하여 선행함
   - 간단한 2D 렌더링 파이프라인을 구현
   - 프레임 버퍼의 화면 갱신은  OnPaint 이벤트핸들러에 일임함. 렌더링 후 드로잉 작업을 분리
- 원 그리기
   - 점 그리기는 과제 안내에 준하여 구현
   - 정원 그리기는 기존 방법을 응용함, 약간 큰 원을 그리고, 약간 작은 원을 바탕색으로 그려 원주를 표현함.
   - 브레즈넘 알고리즘이라는 좋은 비트맵 원그리기 알고리즘을 사용하는게 정석임
   - 세 점을 지나는 원은 삼각형 외접원의 문제임. 만일 세 점이 일직선 상에 있을 경우 외접원이 성립하지 못하는 예외상황이 발생
   - 적당히 큰 크기 (반지름이 80000이 되는 시점)가 넘게 되면 처리하지 않는 방법으로 예외처리.
      - 80000의 값은 원의 곡률이 화면 해상도 내에서 1픽셀 길이 이하로 떨어지는 시점.
- 점 선택 및 드래그
   - LBUTTON_DOWN, LBUTTON_MOVE, LBUTTON_UP 이벤트에 따라 순차적으로 점 오브젝트를 처리
   - 포인터를 클릭한 좌표가 점 내부인 것을 판별하여 드래그할 점을 선택
   - 드래그 이동 시 선택한 점에 포인터 좌표를 갱신하고 렌더링 처리
   - 버튼 업 시 드래그 종료 처리
- 랜덤 이동
   - 기존에 구현된 메서드를 바탕으로 기능을 조합하여 구현
   - 표준 스레드에 메서드 등록하여 UI 프리징을 방지하도록 하였음
   - 랜덤 좌표 생성시 이전과 동일한 좌표가 중복될 위험이 있어 이를 방지하는 예외상황 처리 루틴을 추가하였음

### 결과
- 실행 이미지
 ![실행결과](https://github.com/luciel95/gRimApply/blob/master/%EC%8B%A4%ED%96%89%ED%99%94%EB%A9%B4.png)
- gRimApply/gRimApply/bin/gRimApply.exe를 실행하여 확인
     
## 개발노트
과제 페이지 링크 https://doc.clickup.com/25596452/p/h/rd4h4-262778/9faf6d2e66ff9e7

- 요구사항
    - 비트맵으로 화면에 세 점을 찍어 삼각형 외접원 그리기
    - UI 요구사항
        - 비트맵 화면
        - 도트 드래그
        - [초기화] 버튼
        - [랜덤이동] 버튼
        - 선 두께 지정 에디트박스
- 도트(사실은 원)을 3개 그리고 각 도트가 오브젝트인 것처럼 선택하고 드래그 할 수 있게 구현해야 함.
    - 이 부분이 구현의 핵심
    - 클릭했을 때, 클릭 좌표가 도트의 원 내에 있으면 선택, 드래그 이벤트 시 이동 좌표만큼 이동하여 실시간으로 갱신되도록 구현하면 됨.
    - 프레임버퍼를 매번 갱신해야할 지는 고민해봐야 할 듯.
    - 예외상황 처리를 해야 함. 곡률이 0에 가까운 경우 반지름은 무한대로 발산하므로, 그냥 직선으로 그려짐.
- 삼각형 외접원의 중점 좌표 공식
    
    $$
    x = \frac{ (x_1^2 + y_1^2)(y_2 - y_3) + (x_2^2 + y_2^2)(y_3 - y_1) + (x_3^2 + y_3^2)(y_1 - y_2) }{ 2 \cdot (x_1(y_2 - y_3) + x_2(y_3 - y_1) + x_3(y_1 - y_2))}\\\\ y = \frac{ (x_1^2 + y_1^2)(x_3 - x_2) + (x_2^2 + y_2^2)(x_1 - x_3) + (x_3^2 + y_3^2)(x_2 - x_1) }{ 2 \cdot (x_1(y_2 - y_3) + x_2(y_3 - y_1) + x_3(y_1 - y_2))}
    $$
    
- 삼각형 외접원의 반지름 공식
    - 외접원 중심좌표와 아무 꼭지점 좌표의 거리를 구하면 됨.
    
$$
L = \sqrt {{(x_1 - x)}^2 +{(y_1 - y)}^2}
$$
    
- 예외상황 처리를 해야 함. 곡률이 0에 가까운 경우 반지름은 무한대로 발산하므로, 그냥 직선으로 그려짐.
    - 원래 과제에는 고려되지 않은 부분. 부각시키면 좋을 것 같은데 어떻게 구현해야 하는가??
    - 점을 드래그 하면 쉽게 재현할 수 있다. 반드시 고려해야 함.
    - 원의 중심이 변화할 때, 반지름 R이 80000이 넘으면 화면 해상도에서 1픽셀 이하의 곡률→ 그냥 직선임.
- 도트 클래스 정의
    - 클릭시 세개까지 채워지고 그 다음부터는 안 채워짐. count 해야 함.
    - 도트 클래스는 도트 원의 정의만 가지고 있음.
- 원 그리기
    - 전체 프레임버퍼에서 원을 포함하는 사각형 영역을 계산해야 한다.  메모리를 직접 건드리므로 영역 밖으로 벗어날 수 있다.
    - top left - bottom right영역이 각 경계와 겹칠 때를 주의함.
    - 좌표계는 top-left가 (0,0), bottom-right가 (640,480) 임.
    - 정원 (line circle)을 그리려면, 두께 반만큼 큰 원과 반만큼 작은 원을 겹쳐 그리면 됨.  브레즈넘 알고리즘으로 하면 좋지만…
    - 원을 먼저 그리고 도트를 나중에 그려 원 때문에 도트가 지워지는 것을 방지하자.
- 랜덤 생성 루틴 스레드로 구현
    - thread 클래스로 워킹 스레드 정의
    - 스레드 메서드 등록 0.5초 주기로 데이터 갱신 메시지 포스팅
    - 메시지 이벤트 핸들러 구현 - 데이터 업데이트후 렌더링

완성, 잘 동작합니다. 
